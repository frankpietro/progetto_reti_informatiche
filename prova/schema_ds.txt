SCHEMA DISCOVERY SERVER

select per monitorare arrivo informazioni
se informazioni dal socket {
    ricevo e leggo pacchetto UDP
    se richiesta di connessione {
        invio ack
        aggiungo il peer alla lista di peer connessi
        se primo peer {
            gli invio una lista vuota
        }
        altrimenti {
            cerco i vicini
            compongo la lista da inviare
            la invio
            cerco peer a cui e' cambiata lista di prossimita'
            per ogni vicino {
                compongo lista di prossimita'
                la invio
            }
        }
        aggiorno numero peer connessi
    }
    se richiesta di uscita {
        se ultimo peer
            cancello file peer connessi
        altrimenti {
            elimino peer dalla lista
            cerco peer a cui e' cambiata lista di prossimita'
            per ogni vicino {
                compongo lista di prossimita'
                la invio
            }
        }
        invio ack
    }
}

se informazioni da stdin {
    se help
        stampo i comandi
    se showpeers
        stampo i peer
    se showneighbor {
        stampo i vicini in base a quanti sono
    }
    se esc {
        per ogni peer {
            invio un messaggio di uscita
        }
        cancello file di peer
        chiudo il socket
        esco
    }
    }
